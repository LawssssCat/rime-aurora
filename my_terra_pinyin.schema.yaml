# Rime schema
# encoding: utf-8
#
# 《个人 - 地球拼音》
#
# 部署位置：
# ~/.config/ibus/rime  (Linux)
# ~/Library/Rime  (Mac OS)
# %APPDATA%\Rime  (Windows)
#
# 於重新部署後生效
#
#
# 配置含义：
# https://github.com/LEOYoon-Tsaw/Rime_collections/blob/master/Rime_description.md
#

schema:
  schema_id: my_terra_pinyin
  name: （个人）地球拼音
  version: "0.19"
  author:
    - 佛振 <chen.sst@gmail.com>
    - 骆言 <lawsssscat@163.com>
  description: |
    「漢語拼音」，以符號按鍵 shift + <num 1~4> 輸入四聲
    拼音碼表根據 CC-CEDICT 改編
  dependencies: # 觸發更新製作 bin。 See issue https://github.com/rime/home/issues/1134#issuecomment-1236345551
    - stroke
    - easy_en

switches:
  - name: ascii_mode
    reset: 0
    states: [ 中文, 西文 ]
  - name: full_shape
    states: [ 半角, 全角 ]
  - name: simplification
    states: [ 漢字, 汉字 ]
  - name: ascii_punct
    states: [ 。，, ．， ]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - affix_segmentor@easy_en           # 英文（位置：abc后、punct前）
    - affix_segmentor@easy_en_prev
    - punct_segmentor
    - fallback_segmentor
  translators:
    - lua_translator@time_translator    # 时间
    - table_translator@easy_en          # 英文
    - table_translator@easy_en_prev
    - punct_translator
    - table_translator@custom_phrase
    - reverse_lookup_translator
    - script_translator
  filters:
    - reverse_lookup_filter@e_reverse_lookup
    - simplifier
    - uniquifier

speller:
  # !@#$ 声调
  # ,./ 符号
  alphabet: zyxwvutsrqponmlkjihgfedcba,./&*() # 定义 speller 可以处理的字母
  initials: zyxwvutsrqponmlkjihgfedcba # 定义 speller 接收处理的编码的头字母
  delimiter: " '"
  algebra: # 拼写的运算规则，运算的拼写结果框入prism中
    # xform --改寫〔不保留原形〕
    # derive --衍生〔保留原形〕
    # abbrev --簡拼〔出字優先級較上兩組更低〕
    # fuzz --畧拼〔此種簡拼僅組詞，不出單字〕
    # xlit --變換〔適合大量一對一變換〕
    # erase --刪除
    - erase/^xx$/
    - xform/^r5$/er5/
    - abbrev/^([a-z]).+$/$1/
    - abbrev/^([zcs]h).+$/$1/
    - derive/^([nl])ve/$1ue/
    - derive/^([jqxy])u/$1v/
    - derive/un$/uen/
    - derive/ui/uei/
    - derive/iu/iou/
    - derive/ao/oa/
    - derive/([aeiou])ng/$1gn/
    - derive/([iu])a(o|ng?)/a$1$2/
    - derive/^([a-z]+)[0-5]$/$1/
    - derive/([dtngkhrzcs])o(u|ng)$/$1o/
    - derive/ong$/on/
    - 'xlit 1234 &*()' # !=>1 @=>2 #=>3 $=>4
    # - 'erase/^.*5$/'
    # - 'xlit 1234 -/<\'
    # - 'derive/^(.*)-$/$1;/'
    # - 'derive/^(.*)<$/$1,/'
    # - 'derive/^(.*)\\$/$1>/'
  __patch:
    algebra/+:
      __include: ext_speller:/speller/algebra

translator:
  # dictionary: terra_pinyin
  dictionary: my_terra_pinyin.extended
  spelling_hints: 7  # ～字以內候選標註完整帶調拼音
  contextual_suggestions: true # 是否使用語言模型優化輸出結果〔需配合grammar使用〕
  preedit_format:
    - xform/([nl])v/$1ü/
    - xform/([nl])ue/$1üe/
    - xform/([jqxy])v/$1u/
    - xform/eh/ê/
    # - 'xform ([aeiou])(ng?|r)([-;/<,>\\]) $1$3$2'
    # - 'xform ([aeo])([iuo])([-;/<,>\\]) $1$3$2'
    # - 'xform a[-;] ā'
    # - 'xform a/ á'
    # - 'xform a[<,] ǎ'
    # - 'xform a[>\\] à'
    # - 'xform e[-;] ē'
    # - 'xform e/ é'
    # - 'xform e[<,] ě'
    # - 'xform e[>\\] è'
    # - 'xform o[-;] ō'
    # - 'xform o/ ó'
    # - 'xform o[<,] ǒ'
    # - 'xform o[>\\] ò'
    # - 'xform i[-;] ī'
    # - 'xform i/ í'
    # - 'xform i[<,] ǐ'
    # - 'xform i[>\\] ì'
    # - 'xform u[-;] ū'
    # - 'xform u/ ú'
    # - 'xform u[<,] ǔ'
    # - 'xform u[>\\] ù'
    # - 'xform ü[-;] ǖ'
    # - 'xform ü/ ǘ'
    # - 'xform ü[<,] ǚ'
    # - 'xform ü[>\\] ǜ'
    - 'xform ([aeiou])(ng?|r)([&\*\(\)]) $1$3$2'
    - 'xform ([aeo])([iuo])([&\*\(\)]) $1$3$2'
    - 'xform a[&] ā'
    - 'xform e[&] ē'
    - 'xform i[&] ī'
    - 'xform o[&] ō'
    - 'xform u[&] ū'
    - 'xform a[\*] á'
    - 'xform e[\*] é'
    - 'xform i[\*] í'
    - 'xform o[\*] ó'
    - 'xform u[\*] ú'
    - 'xform a[\(] ǎ'
    - 'xform e[\(] ě'
    - 'xform i[\(] ǐ'
    - 'xform o[\(] ǒ'
    - 'xform u[\(] ǔ'
    - 'xform a[\)] à'
    - 'xform e[\)] è'
    - 'xform i[\)] ì'
    - 'xform o[\)] ò'
    - 'xform u[\)] ù'
  comment_format:
    - xform ([aeiou])(ng?|r)([1234]) $1$3$2
    - xform ([aeo])([iuo])([1234]) $1$3$2
    - xform a1 ā
    - xform a2 á
    - xform a3 ǎ
    - xform a4 à
    - xform e1 ē
    - xform e2 é
    - xform e3 ě
    - xform e4 è
    - xform o1 ō
    - xform o2 ó
    - xform o3 ǒ
    - xform o4 ò
    - xform i1 ī
    - xform i2 í
    - xform i3 ǐ
    - xform i4 ì
    - xform u1 ū
    - xform u2 ú
    - xform u3 ǔ
    - xform u4 ù
    - xform v1 ǖ
    - xform v2 ǘ
    - xform v3 ǚ
    - xform v4 ǜ
    - xform/([nljqxy])v/$1ü/
    - xform/eh[0-5]?/ê/
    - xform/([a-z]+)[0-5]/$1/

custom_phrase:
  dictionary: ""
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

reverse_lookup:
  dictionary: stroke
  enable_completion: true
  prefix: "`" # 前缀标识
  suffix: "'" # 后缀标识
  tips: 〔筆畫〕 # 提示
  preedit_format:
    - xlit/hspnz/一丨丿丶乙/
  comment_format:
    - xform ([aeiou])(ng?|r)([1234]) $1$3$2
    - xform ([aeo])([iuo])([1234]) $1$3$2
    - xform a1 ā
    - xform a2 á
    - xform a3 ǎ
    - xform a4 à
    - xform e1 ē
    - xform e2 é
    - xform e3 ě
    - xform e4 è
    - xform o1 ō
    - xform o2 ó
    - xform o3 ǒ
    - xform o4 ò
    - xform i1 ī
    - xform i2 í
    - xform i3 ǐ
    - xform i4 ì
    - xform u1 ū
    - xform u2 ú
    - xform u3 ǔ
    - xform u4 ù
    - xform v1 ǖ
    - xform v2 ǘ
    - xform v3 ǚ
    - xform v4 ǜ
    - xform/([nljqxy])v/$1ü/
    - xform/eh[0-5]?/ê/
    - xform/([a-z]+)[0-5]/$1/

punctuator:
  import_preset: default
  half_shape:
    __include: ext_punctuator:/half_shape

key_binder:
  import_preset: default
  bindings:
    # - { when: has_menu, accept: minus, send: minus }  # tone 1
    # - { when: paging, accept: minus, send: Page_Up }
  __patch:
    bindings/+:
      __include: ext_bindings:/key_binder/bindings

editor:
  __patch:
    bindings/+:
      __include: ext_bindings:/editor/bindings

recognizer:
  import_preset: default
  patterns:
    reverse_lookup: "`[a-z]*'?$"
    __include: ext_recognizer:/recognizer/patterns
    __include: easy_en:/recognizer/patterns

####################################################
# 英文提示
easy_en:
  __include: easy_en:/easy_en
easy_en_prev:
  __include: easy_en:/easy_en_prev
e_reverse_lookup:
  __include: easy_en:/e_reverse_lookup
####################################################

grammar: # 语法模型
  language: zh-hant-t-essay-bgw

__patch:
  - symbols:/patch